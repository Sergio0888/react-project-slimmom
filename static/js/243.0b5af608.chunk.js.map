{"version":3,"file":"static/js/243.0b5af608.chunk.js","mappings":"wOACA,EAAwD,0B,4GCalDA,EAAe,CACnBC,SAAU,KACVC,mBAAoB,GACpBC,SAAS,EACTC,MAAO,KACPC,SAAS,GAGLC,EAAe,SAAAC,GAAS,yBACzBA,GADyB,IAE5BH,MAAO,KACPD,SAAS,GAHmB,EAMxBK,EAAa,SAACD,EAAWH,GAAZ,eAAC,UACfG,GADc,IAEjBJ,SAAS,EACTC,MAAO,CACLK,QAASL,EAAMM,SAASC,KAAKF,QAC7BG,OAAQR,EAAMM,SAASE,SALR,EA6EnB,EApEiB,WACf,OAA0BC,EAAAA,EAAAA,UAASb,GAAnC,eAAOc,EAAP,KAAcC,EAAd,KACQd,EAA0Ca,EAA1Cb,SAAUC,EAAgCY,EAAhCZ,mBAAoBG,EAAYS,EAAZT,QAEhCW,GAAcC,EAAAA,EAAAA,KACdC,GAAWC,EAAAA,EAAAA,MAEXC,EAAW,mCAAG,WAAMT,GAAN,wFAClBI,EAAST,GACHe,EAAsB,CAAC,EAC7BC,OAAOC,QAAQZ,GAAMa,SAAQ,YAAmB,IAAD,eAAhBC,EAAgB,KAAXC,EAAW,KAC7CL,EAAoBI,GAAOE,OAAOD,EACnC,IALiB,mBAQKE,EAAAA,EAAAA,GAAsBP,GAR3B,OAQVQ,EARU,OASRC,EAAkCD,EAAlCC,UAAW5B,EAAuB2B,EAAvB3B,mBAEb6B,GAAWC,EAAAA,EAAAA,oBAAmB9B,GAC9BD,EAAWgC,KAAKC,MAAMJ,GAC5Bf,GAAS,SAAAR,GAAS,yBACbA,GADa,IAEhBN,SAAAA,EACAC,mBAAoB6B,EACpB5B,SAAS,EACTE,SAAS,GALO,IAbF,kDAqBhB8B,QAAQC,IAAR,MACArB,GAAS,SAAAR,GACP,OAAOC,EAAWD,EAAD,KAClB,IAxBe,0DAAH,uDA4BjB8B,EAAAA,EAAAA,YAAU,WACJhC,IACFa,GAASoB,EAAAA,EAAAA,MACTvB,GAAS,SAAAR,GAAS,yBAAUA,GAAV,IAAqBF,SAAS,GAA9B,IAErB,GAAE,CAACa,EAAUb,IAEd,IAAMkC,EAAmB,WACvBrB,GAASoB,EAAAA,EAAAA,MACTvB,GAAS,SAAAR,GAAS,yBAAUA,GAAV,IAAqBF,SAAS,GAA9B,GACnB,EAED,OACE,iCACE,SAACmC,EAAA,EAAD,KACA,iBAAKC,UAAWC,EAAhB,WACE,gBAAKD,UAAU,YAAf,UACE,SAACE,EAAA,EAAD,CAAmBC,SAAUxB,MAE9BJ,IACC,SAAC6B,EAAA,EAAD,CAAOC,QAASP,EAAhB,UACE,SAACQ,EAAA,EAAD,CACE9C,SAAUA,EACV+C,KAAM9C,EACN+C,QAASV,WAOtB,C","sources":["webpack://react-homework-template/./src/pages/MainPage/MainPage.module.scss?b09f","pages/MainPage/MainPage.jsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"text\":\"MainPage_text__0D2tv\",\"wrapper\":\"MainPage_wrapper__SQ2nS\"};","import s from './MainPage.module.scss';\nimport Header from 'components/Header/Header';\nimport { useEffect, useState } from 'react';\n\nimport { useDispatch } from 'react-redux';\nimport { getDailyRateInGeneral } from 'shared/api/daily';\nimport ModalText from '../../shared/components/ModalText';\nimport { makeRandomProducts } from 'pages/CalculatorPage/CalculatorPage';\nimport { useModal } from '../../shared/hooks/useModal';\nimport { toggleModalRedux } from '../../redux/modal/modal-slice';\n\nimport Modal from 'components/Modal/Modal';\nimport DailyCaloriesForm from 'components/Forms/DailyCaloriesForm/DailyCaloriesForm';\n\nconst initialState = {\n  calories: null,\n  notAllowedProducts: [],\n  loading: false,\n  error: null,\n  isModal: false,\n};\n\nconst loadingState = prevState => ({\n  ...prevState,\n  error: null,\n  loading: true,\n});\n\nconst errorState = (prevState, error) => ({\n  ...prevState,\n  loading: false,\n  error: {\n    message: error.response.data.message,\n    status: error.response.status,\n  },\n});\n\nconst MainPage = () => {\n  const [state, setState] = useState(initialState);\n  const { calories, notAllowedProducts, isModal } = state;\n\n  const isModalOpen = useModal();\n  const dispatch = useDispatch();\n\n  const handleClick = async data => {\n    setState(loadingState);\n    const dataValuesToNumbers = {};\n    Object.entries(data).forEach(([key, value]) => {\n      dataValuesToNumbers[key] = Number(value);\n    });\n\n    try {\n      const result = await getDailyRateInGeneral(dataValuesToNumbers);\n      const { dailyRate, notAllowedProducts } = result;\n\n      const products = makeRandomProducts(notAllowedProducts);\n      const calories = Math.trunc(dailyRate);\n      setState(prevState => ({\n        ...prevState,\n        calories,\n        notAllowedProducts: products,\n        loading: false,\n        isModal: true,\n      }));\n    } catch (error) {\n      console.log(error);\n      setState(prevState => {\n        return errorState(prevState, error);\n      });\n    }\n  };\n\n  useEffect(() => {\n    if (isModal) {\n      dispatch(toggleModalRedux());\n      setState(prevState => ({ ...prevState, isModal: false }));\n    }\n  }, [dispatch, isModal]);\n\n  const modalButtonClick = () => {\n    dispatch(toggleModalRedux());\n    setState(prevState => ({ ...prevState, isModal: false }));\n  };\n\n  return (\n    <>\n      <Header />\n      <div className={s.wrapper}>\n        <div className=\"container\">\n          <DailyCaloriesForm onSubmit={handleClick} />\n        </div>\n        {isModalOpen && (\n          <Modal onClose={modalButtonClick}>\n            <ModalText\n              calories={calories}\n              list={notAllowedProducts}\n              onClick={modalButtonClick}\n            />\n          </Modal>\n        )}\n      </div>\n    </>\n  );\n};\n\nexport default MainPage;\n"],"names":["initialState","calories","notAllowedProducts","loading","error","isModal","loadingState","prevState","errorState","message","response","data","status","useState","state","setState","isModalOpen","useModal","dispatch","useDispatch","handleClick","dataValuesToNumbers","Object","entries","forEach","key","value","Number","getDailyRateInGeneral","result","dailyRate","products","makeRandomProducts","Math","trunc","console","log","useEffect","toggleModalRedux","modalButtonClick","Header","className","s","DailyCaloriesForm","onSubmit","Modal","onClose","ModalText","list","onClick"],"sourceRoot":""}